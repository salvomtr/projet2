__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"getFacebookBootstrapData",{enumerable:!0,get:function(){return f.getFacebookBootstrapData}}),e.getLoginStatus=function(){return _().then(o=>new Promise(t=>o.getLoginStatus(t)))},e.init=_,e.isFacebookLoaded=k,e.login=function(o){return _().then(t=>new Promise(n=>t.login(n,o)))},e.logout=function(){return _().then(o=>new Promise(t=>o.logout(t)))},e.parseXFBML=function(o){return _().then(t=>(t.XFBML&&t.XFBML.parse(o),Promise.resolve()))},e.ui=function(o){return _().then(t=>new Promise(n=>t.ui(o,n)))};var o=babelHelpers.interopRequireDefault(r(d[0])),t=babelHelpers.interopRequireDefault(r(d[1])),n=babelHelpers.interopRequireDefault(r(d[2])),u=babelHelpers.interopRequireDefault(r(d[3])),s=babelHelpers.interopRequireDefault(r(d[4])),c=r(d[5]),l=babelHelpers.interopRequireDefault(r(d[6])),f=r(d[7]);const b=[];function k(){return!!window.FB}function p(){const t=o.default.get('facebook-init');document.querySelector(`script[src="${t.sdkUrl}"]`)||(window.fbAsyncInit=()=>(function(o){for(window.FB.init({appId:o,status:!0,cookie:!0,oauth:!0,version:'v6.0'});b.length>0;)b[0](window.FB),b.shift()})(t.appId),window.Airbnb&&(window.Airbnb.FACEBOOK_PERMS=t.scope),(0,n.default)(t.sdkUrl));const s=new Promise(o=>b.push(o));return(0,u.default)(s,1e4).catch(()=>{throw(0,c.airdogCount)('facebook_sdk_init_timeout'),new Error('FB SDK init timeout')})}function _(){const n=o.default.get('facebook-init');if(null==n||!n.enabled)return Promise.reject(new Error("Facebook SDK isn't supported on this page"));if(l.default.getBootstrap('facebook_sdk_kill_switch'))return Promise.reject(new Error("Facebook SDK isn't enabled because the facebook_sdk_kill_switch trebuchet is enabled"));if(k())return Promise.resolve(window.FB);const u=t.default.tld_country();return l.default.getBootstrap('facebook_sdk_default_off_country_toggle')?new Promise((o,t)=>{(0,s.default)({toolName:'facebook.com',doesCookieHaveConsentCb:n=>{n?((0,c.airdogCount)('facebook_sdk.cookie_check',1,["country:"+u,'sdk_disabled:false']),p().then(t=>o(t))):((0,c.airdogCount)('facebook_sdk.cookie_check',1,["country:"+u,'sdk_disabled:true']),t(new Error("Facebook SDK isn't supported on this page because you have opted out of Facebook third party cookies.")))}})}):((0,c.airdogCount)('facebook_sdk.no_cookie_check',1,["country:"+u]),p())}}),"1bc98d",["05b07c","cf3c1c","8abbba","4ea5d7","7d1fdb","08b665","6b945b","8b20a4"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,o){const n=new Promise((t,n)=>{setTimeout(()=>n(new Error(`Timeout after ${o}ms`)),o)});return Promise.race([t,n])}}),"4ea5d7",[]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.logMigration=function(u,c){return Promise.resolve(u).then(()=>n({...c,result:'success'})).catch(u=>{n({...c,result:'error',responseStatus:null==u?void 0:u.status,noError:!u}),s.default.getBootstrap('niobe.rest.error_logging.kill_switch')||!u||u.status&&200!==u.status||((0,t.airdogCount)('rest_migration.debug',1,{...c,responseStatus:u.status,responseStatusText:u.statusText,message:u.message||'',name:u.name||''}),(0,o().reportNiobeError)(u,{fingerprint:['niobe'],tags:{...c}}))}).catch(()=>{}),u};var t=r(d[0]),s=babelHelpers.interopRequireDefault(r(d[1]));function o(){const t=r(d[2]);return o=function(){return t},t}function n(s){(0,t.airdogCount)('rest_migration.request',1,s)}}),"812e8e",["08b665","6b945b","941d44"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return new Promise((n,c)=>{const o=document.createElement('script');o.type='text/javascript',o.async=!0,o.onload=n,o.onerror=c,o.src=t,(document.head||document.getElementsByTagName('head')[0]).appendChild(o)})}}),"8abbba",[]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.buggyApolloCacheFragmentSelectionsWrite=function(n){return t('NIOBE41')},e.invalidNiobeClientType=function(n){return t(`NIOBE04 [${n}]`)},e.invalidNormalizationPatch=function(){return t('NIOBE42')},e.invalidQueryRefError=function(n){return t('NIOBE11')},e.minimalistOperationGivenToApolloClient=function(n){return t(`NIOBE51 [${n}]`)},e.mismatchingNiobeClientType=function(n,o){return t(`NIOBE05 [${n} ${o}]`)},e.mismatchingQueryRef=function(n,o){return t('NIOBE13')},e.missingSerializedNiobeCache=function(){return t('NIOBE31')},e.niobeClientNotFoundFromContext=function(n){return t(`NIOBE01 [${n}]`)},e.noMatchingQueryRef=function(n){return t('NIOBE12')},e.receivedQueryRefForWrongClient=function({type:n},{type:o}){return t(`NIOBE03 [${n} ${o}]`)},e.reportNiobeError=o,e.ssrTimeoutError=function(n,o){return t(`NIOBE52 [${n}]`)},e.throwNiobeError=function(n){throw n},e.unexpectedlyLoadingObservable=function(n){return t('NIOBE29')},e.unexpectedlyUnloadedPrepareLoader=function(){return t('NIOBE21')},e.unparseableSubscriptionMessage=function(n){return t(`NIOBE71 [${n}]`)},e.warnNiobeError=function(n,t){o(n,t)};var n=r(d[0]);function t(t){return new n.PineappleError(t,{fingerprint:['niobe']})}function o(t,o){(0,n.reportError)(t,o)}}),"941d44",["5511db"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FACEBOOK_ACTION_TYPE=void 0,Object.defineProperty(e,"autologinEnabled",{enumerable:!0,get:function(){return O.autologinEnabled}}),e.default=function(){const k=(0,_.getFacebookBootstrapData)();if(!k)return;(0,l.airdogCount)('facebook.js.get_login_status.started'),(0,_.getLoginStatus)().then(P=>{if((0,h.getFacebookPromptShowCount)()>=h.MAX_FACEBOOK_PROMPT_SHOW)(0,_.logout)().then(()=>{(0,t.default)("fblo_"+k.appId,null,{domain:void 0,path:'/'})}).catch(t=>{const o=new Error(t.message);(0,c.reportError)(o,{originalError:t})}),(0,t.default)('fb_logout',null,{domain:(0,u.getCookieHost)(),path:'/'}),(0,h.disableFacebookAutologin)(),(0,l.airdogCount)('facebook.js.get_login_status.logout');else{if((0,l.airdogCount)('facebook.js.get_login_status.response',1,["status:"+P.status,"is_logged_in:"+s.default.isLoggedIn(),"auto_login:"+(0,O.autologinEnabled)()]),/fb_action_ids=/.test(document.location.search)&&(b.default.getBootstrap('api_web_client_migration.fejax.enabled')&&!b.default.getBootstrap('api_web_client_migration.fejax.signup_login_dls_shared.kill_switch')?(0,p().logMigration)(f().default.post('/users/detect_fb_session'),{method:'POST',client:'niobe',migrationId:'signup_login_dls_shared',group:'fejax'}):(0,p().logMigration)(o.default.post('/users/detect_fb_session'),{method:'POST',client:'fejax',migrationId:'signup_login_dls_shared',group:'fejax'})),s.default.isLoggedIn())return;'connected'!==P.status||(0,h.hasDismissedFacebookPrompt)()||(b.default.getBootstrap('api_web_client_migration.fejax.enabled')&&!b.default.getBootstrap('api_web_client_migration.fejax.signup_login_dls_shared.kill_switch')?(0,p().logMigration)(f().default.post('/users/facebook_auto_login',{body:JSON.stringify({check_linked_airbnb_account:!0}),headers:{'X-Requested-With':'XmlHttpRequest'}}),{method:'POST',client:'niobe',migrationId:'signup_login_dls_shared',group:'fejax'}):(0,p().logMigration)(o.default.post('/users/facebook_auto_login',{check_linked_airbnb_account:!0}),{method:'POST',client:'fejax',migrationId:'signup_login_dls_shared',group:'fejax'})).then(t=>{t.has_linked_airbnb_account?(n.default.emit('initializeFacebookPrompt'),(0,h.setFacebookPromptShowCount)()):((0,h.setHideFacebookPrompt)(),(0,h.disableFacebookAutologin)())})}}).catch(t=>{const o=new Error(t.message);(0,c.reportError)(o,{originalError:t})})},Object.defineProperty(e,"hasDismissedFacebookPrompt",{enumerable:!0,get:function(){return h.hasDismissedFacebookPrompt}});var t=babelHelpers.interopRequireDefault(r(d[0])),o=babelHelpers.interopRequireDefault(r(d[1])),n=babelHelpers.interopRequireDefault(r(d[2])),s=babelHelpers.interopRequireDefault(r(d[3])),l=r(d[4]),u=r(d[5]),_=r(d[6]),c=r(d[7]),b=babelHelpers.interopRequireDefault(r(d[8]));function f(){const t=babelHelpers.interopRequireDefault(r(d[9]));return f=function(){return t},t}function p(){const t=r(d[10]);return p=function(){return t},t}var h=r(d[11]),O=r(d[12]);e.FACEBOOK_ACTION_TYPE={NO_AUTOLOGIN_AND_PROMPT:0,SHOW_FACEBOOK_PROMPT:1,FACEBOOK_AUTO_LOGIN:2}}),"ade67b",["e480b8","638d04","762bdc","c1939d","08b665","b686a9","1bc98d","5511db","6b945b","8f0a62","812e8e","37dbc2","0ef93e"]);
//# sourceMappingURL=https://sourcemaps.d.musta.ch/airbnb/static/packages/web/common/frontend/signup-login-dls-shared/utils/getFacebookLoginStatus.7f11740b72.js.map